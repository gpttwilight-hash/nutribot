# NutriBot ‚Äî –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ v1.0

> Telegram Mini App –¥–ª—è –ø–æ–¥—Å—á—ë—Ç–∞ –∫–∞–ª–æ—Ä–∏–π –∏ —Ç—Ä–µ–∫–∏–Ω–≥–∞ –ø–∏—Ç–∞–Ω–∏—è  
> –í–µ—Ä—Å–∏—è: 1.0 | –î–∞—Ç–∞: —Ñ–µ–≤—Ä–∞–ª—å 2026 | –°—Ç–∞—Ç—É—Å: –ß–µ—Ä–Ω–æ–≤–∏–∫

---

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û–±—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ](#1-–æ–±—â–µ–µ-–æ–ø–∏—Å–∞–Ω–∏–µ)
2. [–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫](#2-—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π-—Å—Ç–µ–∫)
3. [–°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö](#3-—Å—Ö–µ–º–∞-–±–∞–∑—ã-–¥–∞–Ω–Ω—ã—Ö)
4. [–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è](#4-—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è)
5. [–ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è –∏ –ø–æ–¥–ø–∏—Å–∫–∞](#5-–º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è-–∏-–ø–æ–¥–ø–∏—Å–∫–∞)
6. [Backend API](#6-backend-api)
7. [UI/UX —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è](#7-uiux-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è)
8. [–†–æ–∞–¥–º–∞–ø —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏](#8-—Ä–æ–∞–¥–º–∞–ø-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
9. [–ù–µ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è](#9-–Ω–µ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è)
10. [–†–∏—Å–∫–∏ –∏ –º–∏—Ç–∏–≥–∞—Ü–∏—è](#10-—Ä–∏—Å–∫–∏-–∏-–º–∏—Ç–∏–≥–∞—Ü–∏—è)

---

## 1. –û–±—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ

**NutriBot** ‚Äî Telegram Mini App –¥–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–¥—Å—á—ë—Ç–∞ –∫–∞–ª–æ—Ä–∏–π, —Ç—Ä–µ–∫–∏–Ω–≥–∞ –ø–∏—Ç–∞–Ω–∏—è –∏ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏. –ü—Ä–æ–¥—É–∫—Ç –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –Ω–∞ —Ä—É—Å—Å–∫–æ—è–∑—ã—á–Ω—É—é –∞—É–¥–∏—Ç–æ—Ä–∏—é –∏ –º–æ–Ω–µ—Ç–∏–∑–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ –ø–æ–¥–ø–∏—Å–∫—É –≤–Ω—É—Ç—Ä–∏ Telegram.

### 1.1 –¶–µ–ª–∏ –ø—Ä–æ–µ–∫—Ç–∞

- –°–æ–∑–¥–∞—Ç—å —É–¥–æ–±–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ —Ç—Ä–µ–∫–∏–Ω–≥–∞ –ö–ë–ñ–£ (–∫–∞–ª–æ—Ä–∏–∏, –±–µ–ª–∫–∏, –∂–∏—Ä—ã, —É–≥–ª–µ–≤–æ–¥—ã)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ò–ò –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –µ–¥—ã –ø–æ —Ñ–æ—Ç–æ
- –ì–µ–π–º–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ —É–¥–µ—Ä–∂–∞–Ω–∏—è (retention)
- –û–±–µ—Å–ø–µ—á–∏—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –¥–æ—Ö–æ–¥ —á–µ—Ä–µ–∑ –ø–æ–¥–ø–∏—Å–∫—É 500 —Ä—É–±/–º–µ—Å
- –ó–∞–ª–æ–∂–∏—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—É—é –æ—Å–Ω–æ–≤—É –¥–ª—è —Ä–∞–∑–≤–∏—Ç–∏—è –≤ AI-–∫–æ—É—á –ø–æ –ø–∏—Ç–∞–Ω–∏—é –∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞–º

### 1.2 –¶–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è

| –°–µ–≥–º–µ–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| –û—Å–Ω–æ–≤–Ω–∞—è | –ú—É–∂—á–∏–Ω—ã –∏ –∂–µ–Ω—â–∏–Ω—ã 18‚Äì35 –ª–µ—Ç, —Å–ª–µ–¥—è—â–∏–µ –∑–∞ –ø–∏—Ç–∞–Ω–∏–µ–º, —Ö—É–¥–µ—é—â–∏–µ –∏–ª–∏ –Ω–∞–±–∏—Ä–∞—é—â–∏–µ –º–∞—Å—Å—É |
| –í—Ç–æ—Ä–∏—á–Ω–∞—è | –õ—é–¥–∏, –∑–∞–Ω–∏–º–∞—é—â–∏–µ—Å—è —Å–ø–æ—Ä—Ç–æ–º –∏ –∂–µ–ª–∞—é—â–∏–µ —Å–∏—Å—Ç–µ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ |
| –¢—Ä–µ—Ç–∏—á–Ω–∞—è | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ Telegram, –∑–Ω–∞–∫–æ–º—ã–µ —Å –º–∏–Ω–∏-–∞–ø–ø —ç–∫–æ—Å–∏—Å—Ç–µ–º–æ–π |

### 1.3 –ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞

| –ú–µ—Ç—Ä–∏–∫–∞ | –¶–µ–ª—å |
|---------|------|
| DAU/MAU | > 40% |
| Retention Day 7 | > 50% |
| –ö–æ–Ω–≤–µ—Ä—Å–∏—è —Ç—Ä–∏–∞–ª ‚Üí –ø–ª–∞—Ç—ë–∂ | > 15% |
| Churn rate (–ø–ª–∞—Ç—è—â–∏–µ) | < 20%/–º–µ—Å |
| Streak > 7 –¥–Ω–µ–π | 30% –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |

---

## 2. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

### 2.1 Frontend (Telegram Mini App)

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è |
|-----------|------------|
| –Ø–∑—ã–∫ | TypeScript |
| –§—Ä–µ–π–º–≤–æ—Ä–∫ | React 18 + Vite |
| Telegram SDK | `@twa-dev/sdk` (Telegram WebApp API) |
| UI-–±–∏–±–ª–∏–æ—Ç–µ–∫–∞ | `shadcn/ui` + TailwindCSS |
| –°—Ç–µ–π—Ç-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç | Zustand |
| HTTP-–∫–ª–∏–µ–Ω—Ç | Axios + TanStack Query |
| –ì—Ä–∞—Ñ–∏–∫–∏ | Recharts |
| –•–æ—Å—Ç–∏–Ω–≥ | Vercel (–±–µ—Å–ø–ª–∞—Ç–Ω—ã–π tier) |

### 2.2 Backend

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è |
|-----------|------------|
| –Ø–∑—ã–∫ | Python 3.12 |
| –í–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫ | FastAPI |
| Telegram-–±–æ—Ç | aiogram 3.x |
| ORM | SQLAlchemy 2.0 (async) + Alembic |
| –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è | Telegram initData validation (HMAC-SHA256) |
| –§–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏ | Celery + Redis |
| –•–æ—Å—Ç–∏–Ω–≥ | Railway (~$5/–º–µ—Å) |

### 2.3 –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è |
|-----------|------------|
| –°–£–ë–î | PostgreSQL 15 |
| –•–æ—Å—Ç–∏–Ω–≥ –ë–î | Supabase (free tier: 500 MB) |
| –ö—ç—à | Redis (Upstash free tier) |
| –•—Ä–∞–Ω–∏–ª–∏—â–µ —Ñ–æ—Ç–æ | Supabase Storage (–≤—Ä–µ–º–µ–Ω–Ω–æ–µ, –¥–æ –∞–Ω–∞–ª–∏–∑–∞ –ò–ò) |

### 2.4 AI –∏ –≤–Ω–µ—à–Ω–∏–µ API

| –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –†–µ—à–µ–Ω–∏–µ |
|------------|---------|
| –ê–Ω–∞–ª–∏–∑ —Ñ–æ—Ç–æ –µ–¥—ã | OpenAI GPT-4o Vision API |
| –ë–∞–∑–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ | Open Food Facts API (–±–µ—Å–ø–ª–∞—Ç–Ω—ã–π) + —Å–≤–æ—è –±–∞–∑–∞ —Ç–æ–ø-1000 |
| –ü–ª–∞—Ç–µ–∂–∏ | Telegram Stars (–Ω–∞—Ç–∏–≤–Ω–∞—è –æ–ø–ª–∞—Ç–∞ –≤ Telegram) |
| Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è | Telegram Bot API (sendMessage –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é) |

### 2.5 –°—Ç–æ–∏–º–æ—Å—Ç—å –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –Ω–∞ —Å—Ç–∞—Ä—Ç–µ

| –°—Ç–∞—Ç—å—è | –°—Ç–æ–∏–º–æ—Å—Ç—å |
|--------|-----------|
| Railway (–±—ç–∫–µ–Ω–¥) | ~$5/–º–µ—Å |
| Supabase | $0 (free tier) |
| OpenAI API | ~$5‚Äì15/–º–µ—Å (500‚Äì1500 –∞–Ω–∞–ª–∏–∑–æ–≤ —Ñ–æ—Ç–æ/–¥–µ–Ω—å) |
| **–ò—Ç–æ–≥–æ** | **~$10‚Äì20/–º–µ—Å** |

### 2.6 –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```
nutribot/
‚îú‚îÄ‚îÄ frontend/                  # React + TypeScript Mini App
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/        # –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ui/            # shadcn/ui –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ food/          # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–∏—Ç–∞–Ω–∏—è
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ gamification/  # XP, —É—Ä–æ–≤–Ω–∏, —Å—Ç—Ä–∏–∫
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ workout/       # –¢—Ä–µ–∫–µ—Ä —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pages/             # –°—Ç—Ä–∞–Ω–∏—Ü—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Dashboard.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Food.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Workouts.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Profile.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ store/             # Zustand stores
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ userStore.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ foodStore.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ gamificationStore.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api/               # API-–∫–ª–∏–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ client.ts      # Axios instance
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ food.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ workouts.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ subscription.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ hooks/             # Custom hooks
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ utils/             # –£—Ç–∏–ª–∏—Ç—ã (—Ñ–æ—Ä–º—É–ª—ã, —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ types/             # TypeScript —Ç–∏–ø—ã
‚îÇ   ‚îú‚îÄ‚îÄ index.html
‚îÇ   ‚îú‚îÄ‚îÄ vite.config.ts
‚îÇ   ‚îî‚îÄ‚îÄ package.json
‚îÇ
‚îú‚îÄ‚îÄ backend/                   # FastAPI + aiogram
‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ routers/           # FastAPI —Ä–æ—É—Ç–µ—Ä—ã
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ food.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ workouts.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ gamification.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ subscription.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models/            # SQLAlchemy –º–æ–¥–µ–ª–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ food_log.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ workout.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ achievement.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ subscription.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/          # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ai_service.py  # GPT-4o Vision
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ food_service.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ gamification_service.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ subscription_service.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ bot/               # Telegram Bot (aiogram)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ handlers.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ notifications.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tasks/             # Celery –∑–∞–¥–∞—á–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ reminders.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ core/              # Config, Auth, DB
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ config.py
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ auth.py        # JWT + initData validation
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ database.py
‚îÇ   ‚îú‚îÄ‚îÄ alembic/               # –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt
‚îÇ   ‚îî‚îÄ‚îÄ Dockerfile
‚îÇ
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ .env.example
‚îî‚îÄ‚îÄ README.md
```

---

## 3. –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### 3.1 –¢–∞–±–ª–∏—Ü–∞ `users`

```sql
CREATE TABLE users (
    id                    UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    tg_id                 BIGINT UNIQUE NOT NULL,         -- Telegram user ID
    username              VARCHAR(100),                    -- Telegram username
    first_name            VARCHAR(100),
    
    -- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–µ–ª–∞
    goal                  VARCHAR(10) NOT NULL,            -- 'cut' | 'bulk' | 'maintain'
    gender                VARCHAR(10),                     -- 'male' | 'female'
    age                   INT,
    weight_kg             FLOAT,
    height_cm             FLOAT,
    target_weight_kg      FLOAT,
    activity_level        VARCHAR(20),                     -- 'sedentary' | 'moderate' | 'active' | 'athlete'
    
    -- –°—É—Ç–æ—á–Ω—ã–µ –Ω–æ—Ä–º—ã (—Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –ø—Ä–∏ –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–µ)
    daily_calories        INT,
    daily_protein_g       INT,
    daily_fat_g           INT,
    daily_carbs_g         INT,
    
    -- –ì–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏—è
    level                 INT DEFAULT 1,
    xp                    INT DEFAULT 0,
    xp_to_next_level      INT DEFAULT 500,
    streak_days           INT DEFAULT 0,
    max_streak_days       INT DEFAULT 0,
    last_streak_date      DATE,                            -- –î–ª—è –ø–æ–¥—Å—á—ë—Ç–∞ —Å—Ç—Ä–∏–∫–∞
    
    -- –ü–æ–¥–ø–∏—Å–∫–∞
    trial_started_at      TIMESTAMP,
    subscription_status   VARCHAR(20) DEFAULT 'trial',    -- 'trial' | 'active' | 'expired' | 'cancelled'
    subscription_expires_at TIMESTAMP,
    
    created_at            TIMESTAMP DEFAULT NOW(),
    last_active_at        TIMESTAMP DEFAULT NOW()
);
```

### 3.2 –¢–∞–±–ª–∏—Ü–∞ `food_log`

```sql
CREATE TABLE food_log (
    id             UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id        UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
    
    logged_at      TIMESTAMP DEFAULT NOW(),
    meal_type      VARCHAR(20),                            -- 'breakfast' | 'lunch' | 'dinner' | 'snack'
    
    -- –î–∞–Ω–Ω—ã–µ –æ –ø—Ä–æ–¥—É–∫—Ç–µ
    food_name      VARCHAR(200) NOT NULL,
    calories       FLOAT NOT NULL,
    protein_g      FLOAT DEFAULT 0,
    fat_g          FLOAT DEFAULT 0,
    carbs_g        FLOAT DEFAULT 0,
    weight_g       FLOAT DEFAULT 100,
    
    -- –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö
    source         VARCHAR(20) DEFAULT 'manual',           -- 'ai_photo' | 'manual' | 'search'
    photo_url      TEXT,                                   -- –í—Ä–µ–º–µ–Ω–Ω–∞—è —Å—Å—ã–ª–∫–∞, —É–¥–∞–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –∞–Ω–∞–ª–∏–∑–∞
    ai_confidence  FLOAT,                                  -- –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –ò–ò (0.0‚Äì1.0)
    
    created_at     TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_food_log_user_date ON food_log(user_id, logged_at);
```

### 3.3 –¢–∞–±–ª–∏—Ü–∞ `workouts`

```sql
CREATE TABLE workouts (
    id             UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id        UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
    
    workout_date   DATE NOT NULL,
    completed      BOOLEAN DEFAULT FALSE,
    notes          TEXT,                                   -- –î–æ 300 —Å–∏–º–≤–æ–ª–æ–≤
    xp_awarded     INT DEFAULT 0,
    
    created_at     TIMESTAMP DEFAULT NOW(),
    updated_at     TIMESTAMP DEFAULT NOW(),
    
    UNIQUE(user_id, workout_date)                          -- –û–¥–Ω–∞ –∑–∞–ø–∏—Å—å –Ω–∞ –¥–µ–Ω—å
);
```

### 3.4 –¢–∞–±–ª–∏—Ü–∞ `achievements`

```sql
CREATE TABLE achievements (
    id                UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id           UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
    achievement_code  VARCHAR(50) NOT NULL,                -- 'streak_7' | 'streak_30' | 'first_photo' | ...
    achieved_at       TIMESTAMP DEFAULT NOW(),
    notified          BOOLEAN DEFAULT FALSE,               -- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ
    
    UNIQUE(user_id, achievement_code)
);
```

**–°–ø–∏—Å–æ–∫ –∫–æ–¥–æ–≤ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π:**

| –ö–æ–¥ | –ù–∞–∑–≤–∞–Ω–∏–µ | –£—Å–ª–æ–≤–∏–µ |
|-----|----------|---------|
| `streak_7` | –ù–µ–¥–µ–ª—è –±–µ–∑ –ø—Ä–æ–ø—É—Å–∫–æ–≤ | –°—Ç—Ä–∏–∫ 7 –¥–Ω–µ–π |
| `streak_30` | –ú–µ—Å—è—Ü –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—ã | –°—Ç—Ä–∏–∫ 30 –¥–Ω–µ–π |
| `streak_100` | –õ–µ–≥–µ–Ω–¥–∞ | –°—Ç—Ä–∏–∫ 100 –¥–Ω–µ–π |
| `first_photo` | –ò–ò-—Ñ–æ—Ç–æ–≥—Ä–∞—Ñ | –ü–µ—Ä–≤—ã–π –∞–Ω–∞–ª–∏–∑ —Ñ–æ—Ç–æ |
| `first_week` | –ü–µ—Ä–≤–∞—è –Ω–µ–¥–µ–ª—è | 7 –¥–Ω–µ–π –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∏—Ç–∞–Ω–∏—è |
| `workouts_10` | –ù–∞—á–∏–Ω–∞—é—â–∏–π –∞—Ç–ª–µ—Ç | 10 —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ |
| `workouts_50` | –°–ø–æ—Ä—Ç—Å–º–µ–Ω | 50 —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ |
| `workouts_100` | –ñ–µ–ª–µ–∑–Ω—ã–π —á–µ–ª–æ–≤–µ–∫ | 100 —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ |
| `goal_reached` | –¶–µ–ª—å –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞ | –î–æ—Å—Ç–∏–≥ —Ü–µ–ª–µ–≤–æ–≥–æ –≤–µ—Å–∞ |
| `level_10` | –ü—Ä–æ | –î–æ—Å—Ç–∏–≥ 10 —É—Ä–æ–≤–Ω—è |

### 3.5 –¢–∞–±–ª–∏—Ü–∞ `subscriptions`

```sql
CREATE TABLE subscriptions (
    id                    UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id               UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
    
    telegram_payment_id   TEXT UNIQUE,                     -- ID –ø–ª–∞—Ç–µ–∂–∞ –æ—Ç Telegram
    stars_amount          INT,                             -- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ Stars
    status                VARCHAR(20) DEFAULT 'pending',   -- 'pending' | 'active' | 'expired'
    period_days           INT DEFAULT 30,
    
    starts_at             TIMESTAMP,
    expires_at            TIMESTAMP,
    created_at            TIMESTAMP DEFAULT NOW()
);
```

### 3.6 –¢–∞–±–ª–∏—Ü–∞ `weight_log`

```sql
CREATE TABLE weight_log (
    id          UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id     UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
    weight_kg   FLOAT NOT NULL,
    logged_date DATE DEFAULT CURRENT_DATE,
    created_at  TIMESTAMP DEFAULT NOW(),
    
    UNIQUE(user_id, logged_date)
);
```

---

## 4. –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### 4.1 –û–Ω–±–æ—Ä–¥–∏–Ω–≥ –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø—É—Å–∫–∞–µ—Ç –±–æ—Ç–∞ –∫–æ–º–∞–Ω–¥–æ–π `/start`. –ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ –∫–Ω–æ–ø–∫—É –æ—Ç–∫—Ä—ã—Ç–∏—è Mini App. –í–Ω—É—Ç—Ä–∏ ‚Äî wizard –∏–∑ 5 —à–∞–≥–æ–≤:

| –®–∞–≥ | –≠–∫—Ä–∞–Ω | –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ |
|-----|-------|------------|
| 1 | –í—ã–±–æ—Ä —Ü–µ–ª–∏ | –¢—Ä–∏ –∫–∞—Ä—Ç–æ—á–∫–∏: –ü–æ—Ö—É–¥–µ–Ω–∏–µ / –ù–∞–±–æ—Ä –º—ã—à–µ—á–Ω–æ–π –º–∞—Å—Å—ã / –ü–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ |
| 2 | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–µ–ª–∞ | –ü–æ–ª, –≤–æ–∑—Ä–∞—Å—Ç, —Ä–æ—Å—Ç, —Ç–µ–∫—É—â–∏–π –≤–µ—Å, —Ü–µ–ª–µ–≤–æ–π –≤–µ—Å |
| 3 | –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å | 4 —É—Ä–æ–≤–Ω—è: –º–∞–ª–æ–ø–æ–¥–≤–∏–∂–Ω—ã–π / —É–º–µ—Ä–µ–Ω–Ω—ã–π / –∞–∫—Ç–∏–≤–Ω—ã–π / —Å–ø–æ—Ä—Ç—Å–º–µ–Ω |
| 4 | –†–µ–∑—É–ª—å—Ç–∞—Ç | –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–µ –Ω–æ—Ä–º—ã –ö–ë–ñ–£, –º–æ–∂–Ω–æ —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Ä—É—á–Ω—É—é |
| 5 | –°—Ç–∞—Ä—Ç | –ê–∫—Ç–∏–≤–∞—Ü–∏—è 7-–¥–Ω–µ–≤–Ω–æ–≥–æ —Ç—Ä–∏–∞–ª–∞, –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ Dashboard |

**–§–æ—Ä–º—É–ª–∞ —Ä–∞—Å—á—ë—Ç–∞ (–ú–∏—Ñ—Ñ–ª–∏–Ω-–°–∞–Ω –ñ–µ–æ—Ä):**

```python
# –ë–∞–∑–∞–ª—å–Ω—ã–π –º–µ—Ç–∞–±–æ–ª–∏–∑–º
if gender == 'male':
    bmr = 10 * weight + 6.25 * height - 5 * age + 5
else:
    bmr = 10 * weight + 6.25 * height - 5 * age - 161

# –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
activity_multipliers = {
    'sedentary': 1.2,
    'moderate':  1.375,
    'active':    1.55,
    'athlete':   1.725,
}

tdee = bmr * activity_multipliers[activity_level]

# –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —Ü–µ–ª–∏
goal_adjustments = {
    'cut':      0.80,   # -20%
    'maintain': 1.00,
    'bulk':     1.15,   # +15%
}

daily_calories = round(tdee * goal_adjustments[goal])

# –ú–∞–∫—Ä–æ—Å—ã (–ø—Ä–∏–º–µ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ)
daily_protein_g = round(weight * 2.0)           # 2 –≥/–∫–≥ –≤–µ—Å–∞
daily_fat_g     = round(daily_calories * 0.25 / 9)
daily_carbs_g   = round((daily_calories - daily_protein_g * 4 - daily_fat_g * 9) / 4)
```

---

### 4.2 –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω (Dashboard)

**–ë–ª–æ–∫ —Ç–µ–∫—É—â–µ–≥–æ –¥–Ω—è:**
- –ö—Ä—É–≥–æ–≤–∞—è –ø—Ä–æ–≥—Ä–µ—Å—Å-–¥–∏–∞–≥—Ä–∞–º–º–∞ –∫–∞–ª–æ—Ä–∏–π: –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–æ / –æ—Å—Ç–∞–ª–æ—Å—å / —Å—É—Ç–æ—á–Ω–∞—è –Ω–æ—Ä–º–∞
- –¢—Ä–∏ –ø–æ–ª–æ—Å—ã –ø—Ä–æ–≥—Ä–µ—Å—Å–∞: –ë–µ–ª–∫–∏ (–≥), –ñ–∏—Ä—ã (–≥), –£–≥–ª–µ–≤–æ–¥—ã (–≥) —Å –ø—Ä–æ—Ü–µ–Ω—Ç–æ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- –¶–≤–µ—Ç–æ–≤–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è: –∑–µ–ª—ë–Ω—ã–π (< 90%), –∂—ë–ª—Ç—ã–π (90‚Äì100%), –∫—Ä–∞—Å–Ω—ã–π (> 100%)

**–ë–ª–æ–∫ –∏–≥—Ä–æ–≤–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è:**
- –£—Ä–æ–≤–µ–Ω—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ + XP-–±–∞—Ä —Å –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º –¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ —É—Ä–æ–≤–Ω—è
- –°—á—ë—Ç—á–∏–∫ —Å—Ç—Ä–∏–∫–∞ —Å –∏–∫–æ–Ω–∫–æ–π –æ–≥–Ω—è üî• (–ø—É–ª—å—Å–∏—Ä—É–µ—Ç –ø—Ä–∏ —Å—Ç—Ä–∏–∫–µ > 7 –¥–Ω–µ–π)
- –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –±–æ–Ω—É—Å: +10 XP –∑–∞ –ø–µ—Ä–≤–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ (–∫–Ω–æ–ø–∫–∞ "–ó–∞–±—Ä–∞—Ç—å –±–æ–Ω—É—Å")

**–ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:**
- –ö–Ω–æ–ø–∫–∞ `+ –î–æ–±–∞–≤–∏—Ç—å –µ–¥—É` ‚Üí –º–æ–¥–∞–ª—å–Ω—ã–π –≤—ã–±–æ—Ä: –§–æ—Ç–æ / –ü–æ–∏—Å–∫ / –ù–µ–¥–∞–≤–Ω–∏–µ
- –°–ø–∏—Å–æ–∫ –ø—Ä–∏—ë–º–æ–≤ –ø–∏—â–∏ –∑–∞ –¥–µ–Ω—å (—Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω –ø–æ: –ó–∞–≤—Ç—Ä–∞–∫ / –û–±–µ–¥ / –£–∂–∏–Ω / –ü–µ—Ä–µ–∫—É—Å)
- –ö–Ω–æ–ø–∫–∞ `–û—Ç–º–µ—Ç–∏—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É`
- –ö–Ω–æ–ø–∫–∞ `–í–Ω–µ—Å—Ç–∏ –≤–µ—Å`

---

### 4.3 –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –µ–¥—ã: –ò–ò-–∞–Ω–∞–ª–∏–∑ —Ñ–æ—Ç–æ

> ‚ö†Ô∏è –î–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –ø–æ –ø–æ–¥–ø–∏—Å–∫–µ

**Flow:**

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "–§–æ—Ç–æ"
    ‚Üí –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –∫–∞–º–µ—Ä–∞ / –≥–∞–ª–µ—Ä–µ—è Telegram
    ‚Üí –§–æ—Ç–æ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –≤ Supabase Storage
    ‚Üí Backend –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤ OpenAI GPT-4o Vision
    ‚Üí –ü–æ–ª—É—á–∞–µ–º JSON —Å –ö–ë–ñ–£
    ‚Üí –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –∫–∞—Ä—Ç–æ—á–∫—É —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º
    ‚Üí –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ—Ç –≤–µ—Å –ø–æ—Ä—Ü–∏–∏ (—Å–ª–∞–π–¥–µ—Ä –∏–ª–∏ –≤–≤–æ–¥)
    ‚Üí –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç ‚Üí –∑–∞–ø–∏—Å—å –≤ food_log ‚Üí +15 XP
```

**–°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è GPT-4o:**

```
You are a nutrition expert. Analyze the food image and return ONLY valid JSON, no explanations.
Response format:
{
  "dish_name": "string (in Russian)",
  "calories_per_100g": number,
  "protein_g_per_100g": number,
  "fat_g_per_100g": number,
  "carbs_g_per_100g": number,
  "estimated_weight_g": number,
  "confidence": number (0.0 to 1.0)
}
If confidence < 0.6, still return your best guess but with the low confidence value.
```

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∏–∑–∫–æ–π —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ï—Å–ª–∏ `confidence < 0.6` ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ "–ò–ò –Ω–µ —É–≤–µ—Ä–µ–Ω –≤ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞–Ω–Ω—ã–µ."
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å –ª—é–±–æ–µ –ø–æ–ª–µ –≤—Ä—É—á–Ω—É—é –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º

---

### 4.4 –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –µ–¥—ã: —Ä—É—á–Ω–æ–π –ø–æ–∏—Å–∫

**–õ–æ–≥–∏–∫–∞ –ø–æ–∏—Å–∫–∞ (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã):**
1. –°–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è –±–∞–∑–∞ —Ç–æ–ø-1000 –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤ (—Ö—Ä–∞–Ω–∏—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –Ω–∞ –±—ç–∫–µ–Ω–¥–µ)
2. Open Food Facts API (`https://world.openfoodfacts.org/cgi/search.pl`)
3. –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ ‚Äî –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –≤–≤–µ—Å—Ç–∏ –≤—Ä—É—á–Ω—É—é

**UX:**
- –ê–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –æ—Ç 2 —Å–∏–º–≤–æ–ª–æ–≤ (debounce 300ms)
- –ö–∞—Ä—Ç–æ—á–∫–∞ –ø—Ä–æ–¥—É–∫—Ç–∞: –Ω–∞–∑–≤–∞–Ω–∏–µ, –∫–∫–∞–ª/100–≥, –ë/–ñ/–£
- –ü–æ–ª–µ –≤–≤–æ–¥–∞ –≥—Ä–∞–º–º–æ–≤–∫–∏ —Å –ø—Ä–µ—Å–µ—Ç–∞–º–∏: 50–≥ / 100–≥ / 150–≥ / 200–≥ / —Å–≤–æ—ë
- –í—ã–±–æ—Ä –ø—Ä–∏—ë–º–∞ –ø–∏—â–∏: –ó–∞–≤—Ç—Ä–∞–∫ / –û–±–µ–¥ / –£–∂–∏–Ω / –ü–µ—Ä–µ–∫—É—Å
- –†–∞–∑–¥–µ–ª "–ù–µ–¥–∞–≤–Ω–∏–µ" ‚Äî –ø–æ—Å–ª–µ–¥–Ω–∏–µ 20 –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –†–∞–∑–¥–µ–ª "–ò–∑–±—Ä–∞–Ω–Ω–æ–µ" ‚Äî –∑–∞–∫—Ä–µ–ø–ª—ë–Ω–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã (–∏–∫–æ–Ω–∫–∞ ‚≠ê)

---

### 4.5 –ì–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏—è

#### –ù–∞—á–∏—Å–ª–µ–Ω–∏–µ XP

| –î–µ–π—Å—Ç–≤–∏–µ | XP |
|----------|----|
| –ü–µ—Ä–≤–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∑–∞ –¥–µ–Ω—å | +10 |
| –î–æ–±–∞–≤–∏–ª –∑–∞–≤—Ç—Ä–∞–∫ | +15 |
| –î–æ–±–∞–≤–∏–ª –æ–±–µ–¥ | +15 |
| –î–æ–±–∞–≤–∏–ª —É–∂–∏–Ω | +15 |
| –ó–∞–ª–æ–≥–∏—Ä–æ–≤–∞–ª –≤—Å–µ 3 –ø—Ä–∏—ë–º–∞ –ø–∏—â–∏ | +50 (–±–æ–Ω—É—Å) |
| –£–ª–æ–∂–∏–ª—Å—è –≤ –Ω–æ—Ä–º—É –∫–∞–ª–æ—Ä–∏–π (¬±10%) | +30 |
| –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª —Ñ–æ—Ç–æ —Å –ò–ò | +15 |
| –û—Ç–º–µ—Ç–∏–ª —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É | +40 |
| –í–Ω—ë—Å –≤–µ—Å | +10 |
| –°—Ç—Ä–∏–∫ 7 –¥–Ω–µ–π | +100 (–µ–¥–∏–Ω–æ—Ä–∞–∑–æ–≤–æ) |
| –°—Ç—Ä–∏–∫ 30 –¥–Ω–µ–π | +500 (–µ–¥–∏–Ω–æ—Ä–∞–∑–æ–≤–æ) |
| –ü–æ–ª—É—á–∏–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ | +100‚Äì300 (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è) |

#### –°–∏—Å—Ç–µ–º–∞ —É—Ä–æ–≤–Ω–µ–π

```python
def xp_for_level(level: int) -> int:
    """XP, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ —Å level –Ω–∞ level+1"""
    return 500 * (2 ** (level - 1))

# –£—Ä–æ–≤–µ–Ω—å 1‚Üí2:   500 XP
# –£—Ä–æ–≤–µ–Ω—å 2‚Üí3:   1 000 XP
# –£—Ä–æ–≤–µ–Ω—å 3‚Üí4:   2 000 XP
# –£—Ä–æ–≤–µ–Ω—å 4‚Üí5:   4 000 XP
# ...
```

#### –°—Ç—Ä–∏–∫

- –°—Ç—Ä–∏–∫ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞–ª ‚â•1 –ø—Ä–∏—ë–º –ø–∏—â–∏ –∑–∞ –¥–µ–Ω—å
- –°—Ç—Ä–∏–∫ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è, –µ—Å–ª–∏ –ø—Ä–æ—à–ª–æ 2+ –¥–Ω—è –±–µ–∑ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- –ü—Ä–∏ –æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å–±—Ä–æ—Å–∞ (–Ω–µ –∑–∞—Ö–æ–¥–∏–ª —Å–µ–≥–æ–¥–Ω—è) ‚Äî push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ 19:00
- **–ó–∞–º–æ—Ä–æ–∑–∫–∞ —Å—Ç—Ä–∏–∫–∞** (–ø–ª–∞—Ç–Ω–∞—è —Ñ–∏—á–∞, 1 —Ä–∞–∑ –≤ 30 –¥–Ω–µ–π): –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å 1 –¥–µ–Ω—å –±–µ–∑ —Å–±—Ä–æ—Å–∞

#### Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–ª—è —É–¥–µ—Ä–∂–∞–Ω–∏—è

```
08:00 ‚Äî "–î–æ–±—Ä–æ–µ —É—Ç—Ä–æ! –ù–µ –∑–∞–±—É–¥—å –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≤—Ç—Ä–∞–∫ üç≥"
13:00 ‚Äî "–í—Ä–µ–º—è –æ–±–µ–¥–∞! –û—Ç–º–µ—Ç—å —á—Ç–æ –µ–ª ü•ó" (–µ—Å–ª–∏ –Ω–µ –±—ã–ª–æ –∑–∞–ø–∏—Å–∏ —Å 08:00)
19:00 ‚Äî "–¢–≤–æ–π —Å—Ç—Ä–∏–∫ {N} –¥–Ω–µ–π –ø–æ–¥ —É–≥—Ä–æ–∑–æ–π! –ó–∞–π–¥–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ üî•" (–µ—Å–ª–∏ –Ω–µ –∑–∞—Ö–æ–¥–∏–ª)
21:00 ‚Äî "–î–æ –∫–æ–Ω—Ü–∞ –¥–Ω—è {X} –∫–∫–∞–ª. –ö–∞–∫ –ø—Ä–æ—à—ë–ª –¥–µ–Ω—å? üí™"
```

---

### 4.6 –¢—Ä–µ–∫–µ—Ä —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ (MVP)

**–≠–∫—Ä–∞–Ω "–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏":**
- –ú–µ—Å—è—á–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å —Å –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π –ø–æ –º–µ—Å—è—Ü–∞–º
- –î–Ω–∏ —Å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–æ–π –æ—Ç–º–µ—á–µ–Ω—ã: ‚úÖ –∑–µ–ª—ë–Ω–∞—è –≥–∞–ª–æ—á–∫–∞
- –ù–∞–∂–∞—Ç–∏–µ –Ω–∞ –¥–∞—Ç—É ‚Üí –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ:
  - –ß–µ–∫–±–æ–∫—Å "–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞"
  - –ü–æ–ª–µ –¥–ª—è –∑–∞–º–µ—Ç–æ–∫ (–¥–æ 300 —Å–∏–º–≤–æ–ª–æ–≤)
  - –ö–Ω–æ–ø–∫–∞ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"

**–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**
- –¢—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π
- –¢—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π
- –°–∞–º–∞—è –¥–ª–∏–Ω–Ω–∞—è —Å–µ—Ä–∏—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫

> **Roadmap V2:** –¥–µ—Ç–∞–ª—å–Ω—ã–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è (—Å–µ—Ç—ã/–ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è/–≤–µ—Å), AI-–∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –ø–ª–∞–Ω–∞.

---

### 4.7 –†–∞–∑–¥–µ–ª "–ü—Ä–æ—Ñ–∏–ª—å"

- –ê–≤–∞—Ç–∞—Ä (–±–µ—Ä—ë—Ç—Å—è –∏–∑ Telegram) + –∏–º—è + —É—Ä–æ–≤–µ–Ω—å
- XP-–±–∞—Ä —Å –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º
- –¢–µ–∫—É—â–∏–π / –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Å—Ç—Ä–∏–∫
- –°–µ—Ç–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π (–∏–∫–æ–Ω–∫–∏ –±–µ–π–¥–∂–µ–π, –Ω–µ–ø–æ–ª—É—á–µ–Ω–Ω—ã–µ ‚Äî —Å–µ—Ä—ã–µ)
- –ö–Ω–æ–ø–∫–∞ "–ú–æ–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã" ‚Äî —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ü–µ–ª—å, –≤–µ—Å, —Ä–æ—Å—Ç
- –°—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏ + –∫–Ω–æ–ø–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- –ö–Ω–æ–ø–∫–∞ "–ü–æ–¥–¥–µ—Ä–∂–∫–∞" ‚Üí @NutriBotSupport

---

### 4.8 –†–∞–∑–¥–µ–ª "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞"

| –§—É–Ω–∫—Ü–∏—è | –î–æ—Å—Ç—É–ø |
|---------|--------|
| –ì—Ä–∞—Ñ–∏–∫–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π | –ë–µ—Å–ø–ª–∞—Ç–Ω–æ |
| –ì—Ä–∞—Ñ–∏–∫–∏ –∑–∞ 30+ –¥–Ω–µ–π | –¢–æ–ª—å–∫–æ –ø–æ–¥–ø–∏—Å–∫–∞ |
| –î–∏–Ω–∞–º–∏–∫–∞ –≤–µ—Å–∞ (–≥—Ä–∞—Ñ–∏–∫) | –¢–æ–ª—å–∫–æ –ø–æ–¥–ø–∏—Å–∫–∞ |
| –°—Ä–µ–¥–Ω–µ–µ –ö–ë–ñ–£ –∑–∞ –Ω–µ–¥–µ–ª—é vs –Ω–æ—Ä–º–∞ | –ë–µ—Å–ø–ª–∞—Ç–Ω–æ |
| –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö (CSV) | –¢–æ–ª—å–∫–æ –ø–æ–¥–ø–∏—Å–∫–∞ |

---

## 5. –ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è –∏ –ø–æ–¥–ø–∏—Å–∫–∞

### 5.1 –ú–æ–¥–µ–ª—å

| | –¢—Ä–∏–∞–ª | –ü–ª–∞—Ç–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞ |
|--|-------|-----------------|
| –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | 7 –¥–Ω–µ–π | 30 –¥–Ω–µ–π |
| –°—Ç–æ–∏–º–æ—Å—Ç—å | –ë–µ—Å–ø–ª–∞—Ç–Ω–æ | 500 —Ä—É–± (~250‚Äì300 Stars) |
| –î–æ—Å—Ç—É–ø | –ü–æ–ª–Ω—ã–π | –ü–æ–ª–Ω—ã–π |
| –ü–æ—Å–ª–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è | –ë–∞–∑–æ–≤—ã–π –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π —Ä–µ–∂–∏–º | –ë–∞–∑–æ–≤—ã–π –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π —Ä–µ–∂–∏–º |

### 5.2 –ß—Ç–æ –≤–∫–ª—é—á–µ–Ω–æ –±–µ—Å–ø–ª–∞—Ç–Ω–æ (–ø–æ—Å–ª–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è —Ç—Ä–∏–∞–ª–∞)

- –†—É—á–Ω–æ–π –ø–æ–∏—Å–∫ –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –µ–¥—ã
- –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω –∏ —Å—á—ë—Ç—á–∏–∫ –ö–ë–ñ–£
- –ì–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏—è (XP, —É—Ä–æ–≤–Ω–∏, —Å—Ç—Ä–∏–∫)
- –¢—Ä–µ–∫–µ—Ä —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ (—á–µ–∫–±–æ–∫—Å)
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π

### 5.3 –¢–æ–ª—å–∫–æ –ø–æ –ø–æ–¥–ø–∏—Å–∫–µ

- –ò–ò-–∞–Ω–∞–ª–∏–∑ —Ñ–æ—Ç–æ –µ–¥—ã
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ 30+ –¥–Ω–µ–π
- –î–∏–Ω–∞–º–∏–∫–∞ –≤–µ—Å–∞ (–≥—Ä–∞—Ñ–∏–∫)
- –ó–∞–º–æ—Ä–æ–∑–∫–∞ —Å—Ç—Ä–∏–∫–∞
- –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö

### 5.4 Flow –æ–ø–ª–∞—Ç—ã —á–µ—Ä–µ–∑ Telegram Stars

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –Ω–∞ –ø–ª–∞—Ç–Ω—É—é —Ñ–∏—á—É
2. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è Paywall (–∫—Ä–∞—Å–∏–≤—ã–π —ç–∫—Ä–∞–Ω —Å –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞–º–∏)
3. –ö–Ω–æ–ø–∫–∞ "–û—Ñ–æ—Ä–º–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É ‚Äî 500 —Ä—É–±/–º–µ—Å"
4. –í—ã–∑–æ–≤ Telegram.WebApp.openInvoice(invoiceLink)
5. Telegram –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞—Ç–∏–≤–Ω—ã–π —ç–∫—Ä–∞–Ω –æ–ø–ª–∞—Ç—ã Stars
6. –ü–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã ‚Üí Telegram –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç webhook –Ω–∞ /subscription/webhook
7. Backend: —Å–æ–∑–¥–∞—ë—Ç –∑–∞–ø–∏—Å—å –≤ subscriptions, –æ–±–Ω–æ–≤–ª—è–µ—Ç users.subscription_status
8. Push: "–ü–æ–¥–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞! –î–æ—Å—Ç—É–ø –æ—Ç–∫—Ä—ã—Ç üéâ"
```

### 5.5 –¶–µ–ø–æ—á–∫–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π –æ–± –æ–ø–ª–∞—Ç–µ

```
–¢—Ä–∏–∞–ª –¥–µ–Ω—å 5 ‚Üí "–í–∞—à –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –¥–æ—Å—Ç—É–ø –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ 2 –¥–Ω—è"
–¢—Ä–∏–∞–ª –¥–µ–Ω—å 6 ‚Üí "–ó–∞–≤—Ç—Ä–∞ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è —Ç—Ä–∏–∞–ª. –ù–µ —Ç–µ—Ä—è–π –ø—Ä–æ–≥—Ä–µ—Å—Å!"
–¢—Ä–∏–∞–ª –¥–µ–Ω—å 7 ‚Üí "–°–µ–≥–æ–¥–Ω—è –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–Ω—å. –ü—Ä–æ–¥–æ–ª–∂–∏ –∑–∞ 500 —Ä—É–±/–º–µ—Å üî•"
–î–µ–Ω—å –æ–∫–æ–Ω—á–∞–Ω–∏—è ‚Üí Paywall –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –æ—Ç–∫—Ä—ã—Ç–∏–∏
```

---

## 6. Backend API

> –ë–∞–∑–æ–≤—ã–π URL: `https://api.nutribot.app/v1`  
> –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è: `Authorization: Bearer <JWT>`  
> JWT –≤—ã–¥–∞—ë—Ç—Å—è –ø–æ—Å–ª–µ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ Telegram initData

### 6.1 Auth

```http
POST /auth/telegram
Body: { "initData": "string" }
Response: { "access_token": "string", "user": User }

GET /auth/me
Response: User
```

### 6.2 Food Log

```http
# –ü–æ–ª—É—á–∏—Ç—å –ø–∏—Ç–∞–Ω–∏–µ –∑–∞ –¥–µ–Ω—å
GET /food/log?date=2026-02-17
Response: { "entries": FoodEntry[], "totals": Macros, "goal": Macros }

# –î–æ–±–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å—å
POST /food/log
Body: { "food_name", "calories", "protein_g", "fat_g", "carbs_g", "weight_g", "meal_type", "source" }
Response: { "entry": FoodEntry, "xp_awarded": int }

# –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–ø–∏—Å—å
PUT /food/log/{id}
Body: { ...fields }

# –£–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å
DELETE /food/log/{id}

# –ò–ò-–∞–Ω–∞–ª–∏–∑ —Ñ–æ—Ç–æ (—Ç–æ–ª—å–∫–æ –ø–æ–¥–ø–∏—Å–∫–∞)
POST /food/analyze-photo
Body: multipart/form-data { "photo": File }
Response: { "dish_name", "calories_per_100g", "protein_g", "fat_g", "carbs_g", "estimated_weight_g", "confidence" }

# –ü–æ–∏—Å–∫ –ø—Ä–æ–¥—É–∫—Ç–æ–≤
GET /food/search?q=–∫—É—Ä–∏—Ü–∞&limit=20
Response: { "results": FoodItem[] }

# –ù–µ–¥–∞–≤–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
GET /food/recent
Response: { "items": FoodItem[] }

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–∏—Ç–∞–Ω–∏—è
GET /food/stats?period=7d
Response: { "daily": DayStats[], "average": Macros }
```

### 6.3 Workouts

```http
GET /workouts?month=2026-02
Response: { "workouts": Workout[] }

POST /workouts
Body: { "workout_date": "2026-02-17", "completed": true, "notes": "string" }
Response: { "workout": Workout, "xp_awarded": int }

PUT /workouts/{id}
Body: { "completed": bool, "notes": "string" }

GET /workouts/stats
Response: { "last_7_days": int, "last_30_days": int, "best_streak": int }
```

### 6.4 Gamification

```http
GET /gamification/profile
Response: { "level", "xp", "xp_to_next", "streak_days", "max_streak", "achievements": Achievement[] }

GET /gamification/achievements
Response: { "earned": Achievement[], "available": AchievementTemplate[] }

POST /gamification/daily-bonus
Response: { "xp_awarded": 10, "already_claimed": bool }
```

### 6.5 Weight Log

```http
POST /weight/log
Body: { "weight_kg": 75.5, "logged_date": "2026-02-17" }

GET /weight/history?period=30d
Response: { "entries": WeightEntry[] }
```

### 6.6 Subscription

```http
GET /subscription/status
Response: { "status": "trial|active|expired", "expires_at": "datetime", "days_left": int }

POST /subscription/invoice
Response: { "invoice_link": "string" }   # –°—Å—ã–ª–∫–∞ –¥–ª—è Telegram.WebApp.openInvoice()

POST /subscription/webhook              # –í—ã–∑—ã–≤–∞–µ—Ç—Å—è Telegram –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã
Body: Telegram PreCheckoutQuery / SuccessfulPayment
```

### 6.7 –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö (TypeScript)

```typescript
interface User {
  id: string
  tg_id: number
  username: string
  goal: 'cut' | 'bulk' | 'maintain'
  level: number
  xp: number
  xp_to_next_level: number
  streak_days: number
  daily_calories: number
  daily_protein_g: number
  daily_fat_g: number
  daily_carbs_g: number
  subscription_status: 'trial' | 'active' | 'expired' | 'cancelled'
  subscription_expires_at: string
}

interface FoodEntry {
  id: string
  food_name: string
  calories: number
  protein_g: number
  fat_g: number
  carbs_g: number
  weight_g: number
  meal_type: 'breakfast' | 'lunch' | 'dinner' | 'snack'
  source: 'ai_photo' | 'manual' | 'search'
  logged_at: string
}

interface Macros {
  calories: number
  protein_g: number
  fat_g: number
  carbs_g: number
}

interface Workout {
  id: string
  workout_date: string
  completed: boolean
  notes: string | null
}

interface Achievement {
  code: string
  name: string
  description: string
  icon: string
  achieved_at: string | null
}
```

---

## 7. UI/UX —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### 7.1 –û–±—â–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

- –î–∏–∑–∞–π–Ω –ø–æ Telegram Design Guidelines ‚Äî –Ω–∞—Ç–∏–≤–Ω—ã–µ —Ü–≤–µ—Ç–∞ —á–µ—Ä–µ–∑ `Telegram.WebApp.themeParams`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–≤–µ—Ç–ª–æ–π –∏ —Ç—ë–º–Ω–æ–π —Ç–µ–º—ã
- –í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ –ø–µ—Ä–≤–æ–≥–æ —ç–∫—Ä–∞–Ω–∞ ‚Äî ‚â§ 2 —Å–µ–∫—É–Ω–¥—ã
- Skeleton-–∑–∞–≥—Ä—É–∑–∫–∞ –¥–ª—è –≤—Å–µ—Ö –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- Haptic feedback —á–µ—Ä–µ–∑ `Telegram.WebApp.HapticFeedback`:
  - `impact('medium')` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –µ–¥—ã
  - `notification('success')` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ XP/–¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
  - `notification('error')` ‚Äî –ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ –Ω–æ—Ä–º—ã

### 7.2 –ù–∞–≤–∏–≥–∞—Ü–∏—è

–ù–∏–∂–Ω—è—è Tab Bar –∏–∑ 4 –≤–∫–ª–∞–¥–æ–∫:

| –ò–∫–æ–Ω–∫–∞ | –ù–∞–∑–≤–∞–Ω–∏–µ | –°—Ç—Ä–∞–Ω–∏—Ü–∞ |
|--------|----------|----------|
| üè† | –ì–ª–∞–≤–Ω–∞—è | `Dashboard.tsx` |
| üçΩÔ∏è | –ü–∏—Ç–∞–Ω–∏–µ | `Food.tsx` |
| üèãÔ∏è | –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ | `Workouts.tsx` |
| üë§ | –ü—Ä–æ—Ñ–∏–ª—å | `Profile.tsx` |

### 7.3 –ì–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã–µ –∞–Ω–∏–º–∞—Ü–∏–∏

- **+XP –∞–Ω–∏–º–∞—Ü–∏—è**: –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –µ–¥—ã –≤—Å–ø–ª—ã–≤–∞–µ—Ç —Ç–µ–∫—Å—Ç `+15 XP` –Ω–∞–¥ –∫–Ω–æ–ø–∫–æ–π (fadeIn + translateY)
- **Level Up**: –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –ø—Ä–∏ –ø–æ–≤—ã—à–µ–Ω–∏–∏ —É—Ä–æ–≤–Ω—è (–∫–æ–Ω—Ñ–µ—Ç—Ç–∏)
- **–î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ**: bottom sheet —Å –∏–∫–æ–Ω–∫–æ–π –∏ –Ω–∞–∑–≤–∞–Ω–∏–µ–º, –∞–≤—Ç–æ–∑–∞–∫—Ä—ã—Ç–∏–µ —á–µ—Ä–µ–∑ 3 —Å–µ–∫
- **XP-–±–∞—Ä**: –ø–ª–∞–≤–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è (CSS transition 600ms)
- **–°—Ç—Ä–∏–∫ > 7 –¥–Ω–µ–π**: –ø—É–ª—å—Å–∏—Ä—É—é—â–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –∏–∫–æ–Ω–∫–∏ üî• (keyframes scale 1.0‚Üí1.2)

### 7.4 –ö–ª—é—á–µ–≤—ã–µ —ç–∫—Ä–∞–Ω—ã

```
Dashboard
‚îú‚îÄ‚îÄ Header: –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è + —É—Ä–æ–≤–µ–Ω—å + —Å—Ç—Ä–∏–∫
‚îú‚îÄ‚îÄ KBZhU Ring Chart (–∫–∞–ª–æ—Ä–∏–∏)
‚îú‚îÄ‚îÄ Macros Progress Bars (–ë/–ñ/–£)
‚îú‚îÄ‚îÄ Daily Bonus Button (–µ—Å–ª–∏ –Ω–µ –∑–∞–±—Ä–∞–ª)
‚îú‚îÄ‚îÄ Meal List (—Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–æ –ø–æ –ø—Ä–∏—ë–º–∞–º)
‚îî‚îÄ‚îÄ FAB Button "+"

Food Add Modal
‚îú‚îÄ‚îÄ Tab: [–§–æ—Ç–æ] [–ü–æ–∏—Å–∫] [–ù–µ–¥–∞–≤–Ω–∏–µ]
‚îú‚îÄ‚îÄ [–§–æ—Ç–æ tab]: Camera/Gallery picker ‚Üí Loading ‚Üí Result Card
‚îú‚îÄ‚îÄ [–ü–æ–∏—Å–∫ tab]: Search Input ‚Üí Results List ‚Üí Quantity Input
‚îî‚îÄ‚îÄ Confirm Button

Profile
‚îú‚îÄ‚îÄ Avatar + Name + Level Badge
‚îú‚îÄ‚îÄ XP Progress Bar
‚îú‚îÄ‚îÄ Stats: —Å—Ç—Ä–∏–∫ / –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Å—Ç—Ä–∏–∫ / —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫
‚îú‚îÄ‚îÄ Achievements Grid
‚îî‚îÄ‚îÄ Subscription Status Card
```

---

## 8. –†–æ–∞–¥–º–∞–ø —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### MVP ‚Äî –≠—Ç–∞–ø 1 (~6 –Ω–µ–¥–µ–ª—å)

| –ù–µ–¥–µ–ª—è | –ó–∞–¥–∞—á–∏ |
|--------|--------|
| 1 | –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞: Railway, Supabase, GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π, CI/CD (GitHub Actions) |
| 2 | Backend: –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (initData + JWT), –º–æ–¥–µ–ª–∏ –ë–î, Alembic –º–∏–≥—Ä–∞—Ü–∏–∏, –±–∞–∑–æ–≤—ã–µ CRUD |
| 3 | Frontend: Telegram Mini App scaffold, –æ–Ω–±–æ—Ä–¥–∏–Ω–≥ wizard, –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω —Å –ö–ë–ñ–£ |
| 4 | –†—É—á–Ω–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –µ–¥—ã, –ø–æ–∏—Å–∫ (Open Food Facts), —Å–ø–∏—Å–æ–∫ –ø–∏—Ç–∞–Ω–∏—è –∑–∞ –¥–µ–Ω—å |
| 5 | –ò–ò-–∞–Ω–∞–ª–∏–∑ —Ñ–æ—Ç–æ (GPT-4o), –≥–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏—è (XP + —É—Ä–æ–≤–Ω–∏ + —Å—Ç—Ä–∏–∫), —Ç—Ä–µ–∫–µ—Ä —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ |
| 6 | –ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è (Telegram Stars), push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (Celery), —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –¥–µ–ø–ª–æ–π |

### V2 ‚Äî –≠—Ç–∞–ø 2 (~8 –Ω–µ–¥–µ–ª—å –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞)

- [ ] –î–µ—Ç–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏: —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è, –ø–æ–¥—Ö–æ–¥—ã, –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è, —Ä–∞–±–æ—á–∏–π –≤–µ—Å
- [ ] AI-–∞–≥–µ–Ω—Ç: –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ ‚Üí –∫–æ—Ä—Ä–µ–∫—Ü–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫
- [ ] AI-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø–∏—Ç–∞–Ω–∏—é –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Å—Ç–æ—Ä–∏–∏
- [ ] –°–∫–∞–Ω–µ—Ä —à—Ç—Ä–∏—Ö-–∫–æ–¥–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ (QuaggaJS / ZXing)
- [ ] –°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏: —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å—Ç—Ä–∏–∫–æ–≤ —Å –¥—Ä—É–∑—å—è–º–∏
- [ ] –ó–∞–º–æ—Ä–æ–∑–∫–∞ —Å—Ç—Ä–∏–∫–∞ (–ø–ª–∞—Ç–Ω–∞—è —Ñ–∏—á–∞)
- [ ] –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –≤ CSV

### V3 ‚Äî –ü–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–∞

- [ ] –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–ª–∞–Ω –ø–∏—Ç–∞–Ω–∏—è –Ω–∞ –Ω–µ–¥–µ–ª—é –æ—Ç AI-–∫–æ—É—á–∞
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Apple Health / Google Fit
- [ ] –ì—Ä—É–ø–ø–æ–≤—ã–µ —á–µ–ª–ª–µ–Ω–¥–∂–∏
- [ ] –ì–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥ –ø–∏—Ç–∞–Ω–∏—è (Whisper API)

---

## 9. –ù–µ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### 9.1 –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –ü–æ–∫–∞–∑–∞—Ç–µ–ª—å | –¶–µ–ª—å |
|------------|------|
| API response (CRUD) | < 300 –º—Å (p95) |
| AI-–∞–Ω–∞–ª–∏–∑ —Ñ–æ—Ç–æ | < 8 —Å–µ–∫—É–Ω–¥ |
| –ó–∞–≥—Ä—É–∑–∫–∞ Mini App (FCP) | < 2 —Å–µ–∫—É–Ω–¥—ã |
| Uptime | > 99% |

### 9.2 –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ Telegram initData (HMAC-SHA256 + –ø—Ä–æ–≤–µ—Ä–∫–∞ `auth_date` ¬± 5 –º–∏–Ω)
- JWT TTL: access 24h, refresh 30d
- –§–æ—Ç–æ –µ–¥—ã —É–¥–∞–ª—è—é—Ç—Å—è –∏–∑ Supabase Storage —á–µ—Ä–µ–∑ 24 —á–∞—Å–∞ –ø–æ—Å–ª–µ –∞–Ω–∞–ª–∏–∑–∞
- Rate limiting: –Ω–µ –±–æ–ª–µ–µ 10 AI-–∑–∞–ø—Ä–æ—Å–æ–≤/—á–∞—Å –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (Redis counter)
- –í—Å–µ API-—ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Ç—Ä–µ–±—É—é—Ç JWT (–∫—Ä–æ–º–µ `/auth/telegram` –∏ `/subscription/webhook`)

### 9.3 –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å

- –î–æ 10 000 DAU ‚Äî —Ç–µ–∫—É—â–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- –ü—Ä–∏ > 10 000 DAU ‚Äî –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ Railway + Supabase Pro
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ: –±–∞–∑–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ (Redis, TTL 24h), –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (Redis, TTL 5 –º–∏–Ω)

---

## 10. –†–∏—Å–∫–∏ –∏ –º–∏—Ç–∏–≥–∞—Ü–∏—è

| –†–∏—Å–∫ | –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å | –ú–∏—Ç–∏–≥–∞—Ü–∏—è |
|------|-------------|-----------|
| –í—ã—Å–æ–∫–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å OpenAI API –ø—Ä–∏ —Ä–æ—Å—Ç–µ | –°—Ä–µ–¥–Ω—è—è | Rate limiting, –∫—ç—à –ø–æ—Ö–æ–∂–∏—Ö –±–ª—é–¥, –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ Gemini Flash |
| –ù–∏–∑–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å –ò–ò –Ω–∞ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –±–ª—é–¥–∞—Ö | –í—ã—Å–æ–∫–∞—è | –†—É—á–Ω–∞—è –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –≤—Å–µ—Ö –ø–æ–ª–µ–π, feedback-–∫–Ω–æ–ø–∫–∞ "–ù–µ–≤–µ—Ä–Ω–æ" |
| Telegram Stars ‚Äî –Ω–µ—É–¥–æ–±–Ω—ã–π —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π | –°—Ä–µ–¥–Ω—è—è | –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏, –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ ‚Äî –ÆKassa / Robokassa |
| –ù–∏–∑–∫–∞—è –∫–æ–Ω–≤–µ—Ä—Å–∏—è –ø–æ—Å–ª–µ —Ç—Ä–∏–∞–ª–∞ | –°—Ä–µ–¥–Ω—è—è | A/B —Ç–µ—Å—Ç paywall, —É–ª—É—á—à–µ–Ω–∏–µ –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞, email/push –≤–æ—Ä–æ–Ω–∫–∞ |
| –°–±—Ä–æ—Å —Å—Ç—Ä–∏–∫–∞ = –æ—Ç—Ç–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | –í—ã—Å–æ–∫–∞—è | –ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –≤ 19:00, –º–µ—Ö–∞–Ω–∏–∫–∞ –∑–∞–º–æ—Ä–æ–∑–∫–∏ |

---

## –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```env
# Backend (.env)
DATABASE_URL=postgresql+asyncpg://user:pass@host/db
REDIS_URL=redis://...
TELEGRAM_BOT_TOKEN=...
TELEGRAM_WEBHOOK_SECRET=...
OPENAI_API_KEY=...
JWT_SECRET_KEY=...
JWT_ALGORITHM=HS256
SUPABASE_URL=...
SUPABASE_SERVICE_KEY=...
ENVIRONMENT=production

# Frontend (.env)
VITE_API_BASE_URL=https://api.nutribot.app/v1
VITE_BOT_USERNAME=NutriBotApp
```

---

*NutriBot TZ v1.0 | –§–µ–≤—Ä–∞–ª—å 2026*
